\documentclass[pdf, 10pt, unicode]{beamer} %??? Latex2Pdf  tex -> pdf
\usepackage[T2A]{fontenc}
\usepackage[cp1251]{inputenc}
\usepackage[russian]{babel}
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{amsthm}
\usefonttheme[onlymath]{serif}
\usepackage{beamerthemesplit}
\usepackage{subcaption}
\usepackage{cmap}

\usetheme{Frankfurt}
%Warsaw

\setbeamerfont{institute}{size=\normalsize}
\setbeamercolor{bluetext_color}{fg=blue}
\newcommand{\bluetext}[1]{{\usebeamercolor[fg]{bluetext_color}#1}}
\setbeamercovered{transparent}

\title[Ранжирование алгоритмов классификации]{Математические методы диагностики ишемической болезни по электрокардиограмме сверхвысокого разрешения}

\author{И.С. Ямщиков}

\institute{
Научный руководитель: К. В. Воронцов\\
Московский физико-технический институт\\
Факультет управления и прикладной математики\\
Кафедра интеллектуальных систем\\
 }

 \date{
    Москва\\
    июнь 2014г.
}

% счетчик типизации признаков
\newcounter{N}

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\maketitle
\section{Задача}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
  \frametitle{Цель работы}
  Исследуется задача диагностики ишемической болезни по электрокардиограмме высокого разрешения.
  
  \vspace{0.2cm}
   
  Такими электрокардиаграмами называют снимающиеся с частотами более 250Гц (в отличие от стандартных $\leq 100$ Гц)

  \vspace{0.2cm}

  Данная работа базируется на серии работ сотрудников СПбГМУ и ГУАП по моделированию развития ишемии миокарда на крысах.
  
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
  
  \textbf{Идея:}
  \\
  Авторами экспериментов утверждается, что развитие ишемии сопровождается изменениями в высокочастотной части спектра. И эти изменения становятся заметны еще до видимых глазу изменений кардиограммы в целом.
  \vspace{0.1cm}
  
  \begin{figure}
        \centering
        \begin{subfigure}[b]{0.31\textwidth}
           \includegraphics[width=\textwidth]{../img/ft_comparison_mouse_1.png}
        \end{subfigure}
        ~
        \begin{subfigure}[b]{0.31\textwidth}
           \includegraphics[width=\textwidth]{../img/ft_comparison_mouse_16.png}
        \end{subfigure}
        ~
        \begin{subfigure}[b]{0.31\textwidth}
           \includegraphics[width=\textwidth]{../img/ft_comparison_mouse_3.png}
        \end{subfigure}
        \caption{Сравнение спектров записей до и во время операции для трех различных особей}\label{fig:FTComparison}
    \end{figure}
  
  Задача - использовать описанные соображения для классификации ЭКГ на полученные в спокойном состоянии и в ходе развития ишемии.
\end{frame}

\section{Методика}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
  \frametitle{Спектральные признаки}
  
  Введем признаковое описание электрокардиограммы, характеризующее изменение высокочастотных компонент сигнала.
  \\~\\
  Каждая ЭКГ представляет собой временной ряд $ecg_i = ecg_i(t)$
  \\~\\
  Абсолютная величина сигнала зависит от настроек аппаратуры и может внести нежелательные искажения, поэтому
  в дальнейшем все время будем рассматривать нормированный сигнал:
  $$ \widetilde{ecg} = \frac{ecg}{(\|ecg\|_2)^2} $$
  Используем преобразование Фурье:
  $$ \widehat{f}(\omega) = \int_{-\infty}^{\infty}ecg(t) e^{-it\omega}dt $$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
 \frametitle{Признаки, вычисляющиеся по всему сигналу}

  В качестве признаков возьмем $L2$ норму отрезков фурье-образа сигнала:
  $$ F_[\omega_1, \omega_2] = \int\limits_{\omega_1}^{\omega_2} |\widehat{f}(\omega)|^2 d\omega $$
  
  Таким образом, взяв, к примеру, равномерное разбиение отрезка частот [0; 1000]Гц можно получить признаковое описание ЭКГ.
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
  \frametitle{Временная локализация}
  Особенностью описанного выше подхода является то, что признаки строятся по всему сигналу и не учитывают возможных локальных особенностей сигнала ЭКГ.

  \vspace{0.2cm}
  Ставится задача: выделить отдельные участки кардиоцикла, построение спектральных признаков по которым позволит улучшить качество классификации.

  \begin{figure}[h]
        \begin{center}
           \includegraphics[width=45mm]{../img/ecg_waves.png}
        \end{center}
    \end{figure}
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
  \frametitle{Выделение кардиоциклов}
  Для начала необходимо разбить запись на отдельные кардиоциклы. Наиболее часто используемым подходом для этого является выделение R зубца.

  \vspace{0.2cm}

  В существующих работах описано множество подходов детектирования R зубцов.

  \vspace{0.2cm}

  В данной работе используется подход с использованием вейвлет-преобразования.

\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
  \textbf{Алгоритм:}

  \vspace{0.2cm}

  \textbf{Параметры:} масштаб $s$, порог $h$
  \begin{enumerate}
    \item Вычислить вейвлет-преобразование
    $$ T_{s}(b) = \int\limits_{-\infty}^{\infty} ecg(t) \psi^*(\frac{t-b}{s})dt$$
    \item Найти времена, соответствующие локальным максимумам преобразования - $\{t_M\}$
    \item R пики: $\{t_R \in \{t_M\}: \quad T_s(t_R) > h\}$
  \end{enumerate}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
  \frametitle{Новые признаки}
  Пусть для сигнала ЭКГ имеется набор отсчетов, соответствующих R пикам: $t_{R_i}$
  \\~\\
  Вычисляется средняя длина кардиоцикла $\Delta T_R = \left< t_{R_i} - t_{R_{i-1}} \right>$
  \\~\\
  И для каждого пика $R_i$ берется окно, заданное параметрами ширины $\Delta w$ и центра $w_0$:
  $$ \Delta \tau_i = [t_{R_i} + \Delta T_R(w_0 - \frac{\Delta w}{2}); t_{R_i} + \Delta T_R(w_0 + \frac{\Delta w}{2})] $$

  Вычисляется оконное преобразование Фурье, используя окно с носителем $\Delta \tau_i$:
  $$ \widehat{f_i}(\omega) = \int_{-\infty}^{\infty}W_{\Delta \tau_i}(t)ecg(t) e^{-it\omega}dt $$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}

  Аналогично предыдущему пункту выделяются признаки:
  $$ Fw_{\Delta w, w_0}[\omega_1, \omega_2] = \sum_i \int\limits_{\omega_1}^{\omega_2} \widehat{f}_{t_i} d\omega$$

  В качестве интервалов частот в данной работе рассматривается равномерная сетка интервалов на $0-2000$ Гц, задающаяся параметром $n$ - числом интервалов:
  
  $$ w_i = \frac{i}{n} 2000,\quad i\in[0,n] $$
  
  \vspace{0.2cm}
  Таким образом признаковое описание объекта будет зависить от параметров $(\Delta w, w_0, n)$.
  \\~\\
  В дальнейшем будет проводиться исследование качества классификации в зависимости от этих параметров.
\end{frame}

\section{Эксперименты}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
  \frametitle{Данные}
    \textbf{Данные}
  
    Имеются кардиограммы высокого разрешения полученные в ходе эксперимента по моделированию ишемии миокарда на крысах.
    
    \vspace{0.2cm}
    
    В выборке 20 крыс, записи длиной порядка 2 секунд, частота 2кГц.
    
    \vspace{0.2cm}
    
    Рассматриваются кардиограммы особей в двух состояниях:
    \begin{itemize}
        \item Здоровая особь
        \item Раннее развитие ишемии
    \end{itemize}
    \vspace{0.2cm}
    Требуется по высокочастотной части кардиограммы восстановить состояние особи
    
    \vspace{0.2cm}
    
    Метрикой качества будет являтся оценка $5\times5 fold$ кросс-валидации классификатора SVM с линейным ядром.
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
    Пример данных - низкочастотный и высокочастотный сигналы:
    
    \begin{figure}[h]
        \begin{center}
           \includegraphics[width=75mm]{../img/record_5_1_high_n_low.png}
        \end{center}
        \caption{ЭКГ крысы. Низкочастотный (сверху) и высокочастотный (снизу) каналы.}
    \end{figure}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
    \frametitle{Классификатор, использующий признаки на основе преобразования Фурье всего сигнала.}
    В качестве частотной сетки взята равномерная сетка на [0;1000] Гц интервале, поделенном на 10 частей.
    \\~\\
    Качество классификации - \textbf{$75.7\%$}
    \\~\\
    \begin{figure}[h]
        \begin{center}
           \includegraphics[width=55mm]{../img/old_roc.png}
        \end{center}
        \caption{ROC кривая}
    \end{figure}
    
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
    \frametitle{Классификатор, использующий признаки на основе оконного преобразования Фурье}
    
    \vspace{0.2cm}
    
    \begin{figure}[h]
        \begin{center}
           \includegraphics[width=75mm]{../img/CV_on_window_center.png}
        \end{center}
        \caption{Зависимость оценки $5\times5 fold$ кросс-валидации от центра окна (ширина окна $\Delta w = 0.4$, количество разбиений $n=8$)}
    \end{figure}
    
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
    \vspace{0.2cm}
    
    Зависимость оценки $5\times5 fold$ кросс-валидации от ширины окна и количества разбиений:
    \begin{figure}
        \centering
        \begin{subfigure}[b]{0.5\textwidth}
           \includegraphics[width=\textwidth]{../img/CV_on_fq_divisions.png}
           \caption{Зависимость от количества разбиений, ширина окна $\Delta w = 0.4$}
        \end{subfigure}%
        ~
        \begin{subfigure}[b]{0.5\textwidth}
           \includegraphics[width=\textwidth]{../img/CV_on_window_size.png}
           \caption{Зависимость оценки от ширины окна, количество разбиений $n=8$}
        \end{subfigure}
    \end{figure}
    
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
    \frametitle{Результаты}
    Оценки $5\times5 fold$ кросс-валидации:
    \\~\\
    \begin{tabular}{|l|c|}
        \hline
        Весь сигнал & $75.7\%$ \\
        \hline
        Окно размером $\Delta w = 0.4$ с центром в R пике & $89.1\%$\\
        \hline
    \end{tabular}
    \\~\\
    \begin{figure}[h]
        \begin{center}
           \includegraphics[width=55mm]{../img/old_vs_new_roc.png}
        \end{center}
        \caption{Сравнение ROC кривых}
    \end{figure}
    
\end{frame}

\section{Выводы}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
  \frametitle{Выводы}
  \begin{itemize}
    \item Разработан метод диагностики ишемической болезни по данным ЭКГ высокого разрешения, основанный на локализации амплитудно-частотной характеристики ЭКГ-сигнала.
  \end{itemize}
\end{frame}

\end{document}
